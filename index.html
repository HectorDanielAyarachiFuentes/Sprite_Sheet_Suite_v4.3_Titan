<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sprite Sheet Suite v4.3 "Titan"</title>
    <!-- Librer√≠as Externas -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gif.js/0.2.0/gif.js"></script>
    <link rel="stylesheet" href="style.css">

    <!-- ================================================== -->
    <!-- Metadatos B√°sicos y SEO -->
    <meta name="description" content="Una suite de herramientas web profesional para cortar, previsualizar y exportar animaciones desde hojas de sprites (sprite sheets).">
    <meta name="keywords" content="sprite sheet, spritesheet, animation, game development, pixel art, asset creation, css animation, gif">
    <meta name="author" content="H√©ctor Daniel Ayarachi Fuentes">

    <!-- Favicon SVG -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><rect width='16' height='16' fill='%231a1b26'/><rect x='2' y='2' width='5' height='5' fill='%2324283b'/><rect x='9' y='2' width='5' height='5' fill='%2324283b'/><rect x='2' y='9' width='5' height='5' fill='%2324283b'/><rect x='9' y='9' width='5' height='5' fill='%237aa2f7'/></svg>">

    <!-- Metadatos para Open Graph (Facebook, Discord, etc.) -->
    <meta property="og:title" content="Sprite Sheet Suite v4.3 'Titan'">
    <meta property="og:description" content="Herramienta web todo en uno para cortar, previsualizar y exportar hojas de sprites.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://hectordanielayarachifuentes.github.io/Herramienta-de-Corte-de-Sprite-Sheets/">
    <meta property="og:image" content="https://raw.githubusercontent.com/HectorDanielAyarachiFuentes/Herramienta-de-Corte-de-Sprite-Sheets/main/img-md/image.png">

    <!-- Metadatos para Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Sprite Sheet Suite v4.3 'Titan'">
    <meta name="twitter:description" content="Herramienta web todo en uno para cortar, previsualizar y exportar hojas de sprites.">
    <meta name="twitter:image" content="https://raw.githubusercontent.com/HectorDanielAyarachiFuentes/Herramienta-de-Corte-de-Sprite-Sheets/main/img-md/image.png">
    <!-- ================================================== -->

</head>
<body>

    <div id="welcome-screen">
        <div id="drop-zone">
            <h2>Sprite Sheet Suite v4.3</h2>
            <p>Arrastra y suelta tu imagen aqu√≠ o selecci√≥nala</p>
            <label for="image-loader" id="image-loader-label">Seleccionar Archivo</label>
            <input type="file" id="image-loader" accept="image/*">
        </div>
    </div>

    <div class="app-container" style="visibility: hidden;">
        <!-- PANEL IZQUIERDO: Jerarqu√≠a y Navegaci√≥n -->
        <div class="left-panel">
             <div class="panel">
                <h3>Historial de Proyectos</h3>
                <ul id="project-history-list"></ul>
            </div>
             <div class="panel">
                <h3>Clips de Animaci√≥n</h3>
                <div class="input-group">
                    <select id="clips-select"></select>
                    <button id="new-clip-button" class="icon-btn" title="Nuevo Clip">
                        <svg viewBox="0 0 24 24"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>
                    </button>
                    <button id="rename-clip-button" class="icon-btn" title="Renombrar Clip">
                        <svg viewBox="0 0 24 24"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/></svg>
                    </button>
                    <button id="delete-clip-button" class="icon-btn" title="Eliminar Clip">
                        <svg viewBox="0 0 24 24"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>
                    </button>
                </div>
                <h3>Frames del Clip</h3>
                <p class="help-text">La lista muestra todos los sub-frames disponibles. Haz doble clic en el editor visual para a√±adirlos/quitarlos.</p>
                <div class="input-group" style="margin-bottom: 10px;">
                    <button id="select-all-frames" class="small-action">Todos</button>
                    <button id="deselect-all-frames" class="small-action">Ninguno</button>
                </div>
                <ul id="frames-list"></ul>
            </div>
        </div>

        <!-- PANEL CENTRAL: Editor Principal -->
        <div class="main-panel">
            <div class="panel header-panel">
                <div>
                    <h1>Sprite Sheet Suite <span class="version">v4.3 Titan</span></h1>
                    <p id="image-dimensions" style="margin: 5px 0 0 0;"></p>
                </div>
                <button id="change-image-button">Cambiar Imagen</button>
            </div>
            <div class="panel editor-area-container">
                <div id="editor-toolbar">
                    <button id="add-v-slice-button" class="ruler-btn" title="A√±adir L√≠nea Vertical" disabled>
                        <svg viewBox="0 0 24 24"><path d="M11 2h2v20h-2z"/></svg>
                    </button>
                    <button id="add-h-slice-button" class="ruler-btn" title="A√±adir L√≠nea Horizontal" disabled>
                        <svg viewBox="0 0 24 24"><path d="M2 11h20v2H2z"/></svg>
                    </button>
                    <button id="fullscreen-button" class="ruler-btn" title="Pantalla Completa (M)">
                        <svg viewBox="0 0 24 24"><path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/></svg>
                    </button>
                </div>
                <div class="editor-area">
                    <div class="ruler-corner"></div>
                    <canvas id="ruler-top"></canvas>
                    <canvas id="ruler-left"></canvas>
                    <div id="image-container">
                        <img id="image-display" src="" alt="Sprite sheet">
                        <canvas id="measurement-canvas"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- PANEL DERECHO: Propiedades y Acciones -->
        <div class="side-panel">
             <div class="panel">
                <h3>Previsualizaci√≥n</h3>
                <canvas id="preview-canvas" width="150" height="150" style="background-color: var(--bg-dark); border: 1px solid var(--border-color); margin: 0 auto 10px; display: block; image-rendering: pixelated;"></canvas>
                <div class="input-group" style="justify-content: center;">
                    <button id="first-frame-button" class="icon-btn" disabled>‚èÆÔ∏è</button>
                    <button id="play-pause-button" class="icon-btn" disabled>‚ñ∂Ô∏è</button>
                    <button id="last-frame-button" class="icon-btn" disabled>‚è≠Ô∏è</button>
                </div>
                <div class="input-group" style="justify-content: center;">
                    <label for="fps-slider">FPS: <span id="fps-value">12</span></label>
                    <input type="range" id="fps-slider" min="1" max="60" value="12" style="width: 150px;" disabled>
                </div>
            </div>
            <div class="panel">
                <h3>Edici√≥n de Frames</h3>
                <div class="input-group">
                    <button id="undo-button" class="icon-btn" disabled title="Deshacer (Ctrl+Z)">‚Ü©Ô∏è</button>
                    <button id="redo-button" class="icon-btn" disabled title="Rehacer (Ctrl+Y)">‚Ü™Ô∏è</button>
                    <button id="lock-frames-button" class="icon-btn" title="Bloquear/Desbloquear Frame Principal (L)">üîì</button>
                    <button id="clear-button" disabled>Limpiar Todo</button>
                </div>
                 <details>
                    <summary>Ajuste Manual</summary>
                     <div style="padding: 10px 0;">
                        <p class="help-text">
                           - <b>Crear Frame:</b> Haz clic y arrastra en un √°rea vac√≠a.<br>
                           - <b>Seleccionar/Mover:</b> Haz clic y arrastra un frame.<br>
                           - <b>Redimensionar:</b> Arrastra los puntos de control de un frame seleccionado.<br>
                           - <b>Eliminar Frame:</b> Selecciona un frame y presiona 'Supr' o 'Retroceso'.<br>
                           - <b>A√±adir/Quitar del Clip:</b> Haz doble clic en un sub-frame.
                        </p>
                    </div>
                </details>
                <details id="slicer-details" open>
                    <summary>Divisiones Internas (Frame Seleccionado)</summary>
                    <div style="padding: 10px 0;">
                        <p class="help-text">
                            Selecciona un frame para activar los botones de divisi√≥n en la esquina del editor.<br>
                            - <b>Mover Segmento (Alt + Arrastrar):</b> Mueve solo un segmento de l√≠nea vertical en una fila.<br>
                            - <b>Mover L√≠nea Completa:</b> Arrastra una l√≠nea para ajustarla globalmente.<br>
                            - <b>Eliminar Segmento (Doble Clic):</b> Elimina un segmento de l√≠nea individual.<br>
                            - <b>Resetear Segmento (Alt + Doble Clic):</b> Devuelve un segmento modificado a su posici√≥n global.<br>
                            - <b>Eliminar L√≠nea Completa (Ctrl + Doble Clic):</b> Elimina una l√≠nea vertical en todas las filas.
                         </p>
                    </div>
                </details>
                <details>
                    <summary>Generaci√≥n de Parrilla Global</summary>
                    <div style="padding: 10px 0;">
                        <p class="help-text">Genera una parrilla que cubre toda la imagen. Borrar√° los frames existentes.</p>
                        <div class="input-group">
                            <label>Filas:</label><input type="number" id="rows-input" value="2" min="1">
                            <label>Columnas:</label><input type="number" id="cols-input" value="5" min="1">
                            <button id="generate-grid-button" disabled>Generar por Parrilla</button>
                        </div>
                        <div class="input-group">
                            <label>Ancho Celda:</label><input type="number" id="cell-w-input" value="64" min="1">
                            <label>Alto Celda:</label><input type="number" id="cell-h-input" value="64" min="1">
                            <button id="generate-by-size-button" disabled>Generar por Tama√±o</button>
                        </div>
                    </div>
                </details>
            </div>
            <div class="panel" id="export-panel">
                <h3>Exportar</h3>
                <!-- INICIO: Contenedor a√±adido para corregir el layout -->
                <div class="export-options">
                    <details>
                        <summary>Exportar Frames Individuales</summary>
                        <div style="padding-top: 10px;">
                            <button id="export-zip-button" disabled>Descargar Frames (ZIP)</button>
                        </div>
                    </details>
                    <details>
                        <summary>Exportar Clip a GIF</summary>
                        <div style="padding-top: 10px;">
                            <div class="input-group">
                                <label>Tama√±o M√°x:</label><input type="number" id="max-gif-size" value="128" min="16">
                            </div>
                            <button id="export-gif-button" disabled>Descargar GIF</button>
                        </div>
                    </details>
                    <details id="code-export-details">
                        <summary>Exportar a C√≥digo</summary>
                        <div style="padding-top: 10px;">
                            <button id="export-code-button" disabled>Generar HTML/CSS</button>
                            <div id="code-preview-container">
                                <div class="code-editors">
                                    <div class="code-editor">
                                        <div class="code-editor-header">
                                            HTML
                                            <button class="copy-button" data-target="html-code-output">Copiar</button>
                                        </div>
                                        <div class="code-editor-body">
                                            <div class="line-numbers" id="html-line-numbers"></div>
                                            <pre><code id="html-code-output"></code></pre>
                                        </div>
                                    </div>
                                    <div class="code-editor">
                                        <div class="code-editor-header">
                                            CSS
                                            <button class="copy-button" data-target="css-code-output">Copiar</button>
                                        </div>
                                        <div class="code-editor-body">
                                            <div class="line-numbers" id="css-line-numbers"></div>
                                            <pre><code id="css-code-output"></code></pre>
                                        </div>
                                    </div>
                                </div>
                                <div class="live-preview-container">
                                    <iframe id="live-preview-iframe" title="Live Preview"></iframe>
                                </div>
                            </div>
                        </div>
                    </details>
                    <details>
                        <summary>Exportar Datos a JSON</summary>
                        <div style="padding-top: 10px;">
                            <div class="input-group">
                                <label>Formato:</label>
                                <select id="json-format-select">
                                    <option value="default">Por Defecto</option>
                                    <option value="phaser3">Phaser 3</option>
                                    <option value="godot">Godot</option>
                                </select>
                            </div>
                            <div class="code-editor">
                                <div class="code-editor-header">
                                    JSON
                                    <button class="copy-button" data-target="json-output">Copiar</button>
                                </div>
                                <div class="code-editor-body">
                                    <div class="line-numbers" id="json-line-numbers"></div>
                                    <pre><code id="json-output"></code></pre>
                                </div>
                            </div>
                        </div>
                    </details>
                </div>
                <!-- FIN: Contenedor a√±adido -->
            </div>
        </div>
    </div>
    <div id="toast"></div>

    <footer class="app-footer">
       <p>
           <span>Creado por H√©ctor Daniel Ayarachi Fuentes</span>
           <a href="https://github.com/HectorDanielAyarachiFuentes" target="_blank" rel="noopener noreferrer" title="GitHub">
               <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" role="img" aria-label="GitHub icon">
                   <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path>
               </svg>
           </a>
           <a href="https://codepen.io/HectorDanielAyarachiFuentes" target="_blank" rel="noopener noreferrer" title="CodePen">
               <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" role="img" aria-label="CodePen icon">
                   <path d="M24 8.32l-12 8.32-12-8.32v-3.64l12-8.32 12 8.32v3.64zm-12 11.36l-12-8.32v3.64l12 8.32 12-8.32v-3.64l-12 8.32z"></path>
               </svg>
           </a>
       </p>
    </footer>

    <script type="module" src="script.js"></script>
</body>
</html>
